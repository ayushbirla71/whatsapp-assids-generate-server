option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: main:app
  aws:elasticbeanstalk:application:environment:
    PYTHONPATH: "/var/app/current:$PYTHONPATH"
  aws:autoscaling:launchconfiguration:
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
  aws:autoscaling:asg:
    MinSize: 1
    MaxSize: 5
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
  aws:elasticbeanstalk:command:
    BatchSize: 30
    BatchSizeType: Percentage
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /health

packages:
  yum:
    git: []
    postgresql-devel: []

files:
  "/opt/elasticbeanstalk/tasks/bundlelogs.d/01-app-logs.conf":
    mode: "000644"
    owner: root
    group: root
    content: |
      /var/app/current/logs/*.log

container_commands:
  01_create_directories:
    command: "mkdir -p /var/app/current/logs /var/app/current/temp_assets"
  02_set_permissions:
    command: "chmod 755 /var/app/current/logs /var/app/current/temp_assets"
  03_install_requirements:
    command: "pip install -r requirements.txt"
    leader_only: true
